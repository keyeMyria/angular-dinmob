<h1 mat-dialog-title>Editar Cliente</h1>
<div mat-dialog-content>

  <mat-tab-group>

    <!-- Datos Generales -->
    <mat-tab label="Cliente">
      <div class="container py-3">
        <form [formGroup]="formGenerales" (ngSubmit)="guardarGenerales()">

          <div class="form-group row">
            <label for="nombre" class="col-form-label col-sm-3">Nombre</label>
            <div class="col-sm-9">
              <input type="text" class="form-control" id="nombre" name="nombre" formControlName="nombre" [ngClass]="{'is-invalid': formGenerales.get('nombre').invalid  && (formGenerales.get('nombre').dirty || formGenerales.get('nombre').touched )}">
              <div class="invalid-feedback">Proporcione un nombre</div>
            </div>
          </div>

          <div class="form-group row">
            <label for="fecha_nacimiento" class="col-form-label col-sm-3">Fecha Nacimiento</label>
            <div class="input-group col-sm-9">
              <input class="form-control" placeholder="yyyy-mm-dd" type="text" id="fecha_nacimiento" placement="bottom-left" [matDatepicker]="dpFechaNacimiento"
                formControlName="fecha_nacimiento" [ngClass]="{'is-invalid':formGenerales.get('fecha_nacimiento').invalid && (formGenerales.get('fecha_nacimiento').dirty || formGenerales.get('fecha_nacimiento').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaNacimiento.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formGenerales.get('fecha_nacimiento').invalid && (formGenerales.get('fecha_nacimiento').dirty || formGenerales.get('fecha_nacimiento').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaNacimiento></mat-datepicker>
          </div>

          <div class="form-group row">
            <label for="curp_cliente" class="col-form-label col-sm-3">CURP</label>
            <div class="col-sm-9">
              <input [textMask]="{mask: maskCURP}" type="text" class="form-control" id="curp_cliente" name="curp_cliente" formControlName="curp_cliente"
                [ngClass]="{'is-invalid': formGenerales.get('curp_cliente').invalid  && (formGenerales.get('curp_cliente').dirty || formGenerales.get('curp_cliente').touched )}">
              <div class="invalid-feedback">Proporcione una Curp</div>
            </div>
          </div>

          <div class="form-group row">
            <label for="telefono_cliente" class="col-form-label col-sm-3">Teléfono</label>
            <div class="col-sm-9">
              <input [textMask]="{mask: maskPhone}" type="text" class="form-control" id="telefono_cliente" name="telefono_cliente" formControlName="telefono_cliente"
                [ngClass]="{'is-invalid': formGenerales.get('telefono_cliente').invalid  && (formGenerales.get('telefono_cliente').dirty || formGenerales.get('telefono_cliente').touched )}">
              <div class="invalid-feedback">Proporcione un numero telefónico</div>
            </div>
          </div>

        </form>
      </div>

    </mat-tab>

    <!-- <Documentos> -->
    <mat-tab label="Documentos">
      <div class="container py-3">
        <form [formGroup]="formDocumentos" (ngSubmit)="guardarDocumentos()">
          <mat-selection-list>
            <mat-list-option>
              Curp
            </mat-list-option>
            <mat-list-option>
              IFE
            </mat-list-option>
            <mat-list-option>
              RFC
            </mat-list-option>
          </mat-selection-list>
        </form>
      </div>
    </mat-tab>

    <!-- <Inmueble> -->
    <mat-tab label="Inmueble">
      <div class="container py-3">

        <!-- Compras -->
        <div class="table-responsive">
          <table class="table table-striped table-hover table-align-middle table-striped mb-4">
            <thead>
              <tr>
                <!-- style="width:56px" -->
                <th></th>
                <th>Lote</th>
                <th>Estado</th>
                <th>Activación</th>
                <th>Cancelación</th>
                <th class="text-right" style="width:66px">
                  <button mat-icon-button (click)="nuevaCompra()" matTooltip="Nuevo Lote">
                    <mat-icon>add</mat-icon>
                  </button>
                </th>
              </tr>
            </thead>
            <tbody>
              <tr class="pointer" (click)="selectCliente(cliente)" [ngClass]="{'table-primary':selection.isSelected(cliente)}" *ngFor="let cliente of clientes">
                <td>
                  <mat-checkbox class="pl-2" (click)="$event.stopPropagation()" (change)="$event ? selectCliente(cliente) : null" [checked]="selection.isSelected(cliente)"></mat-checkbox>
                </td>
                <td class="ws-nowrap">{{cliente.obra + "/" + cliente.manzana + "/" }}
                  <strong>{{cliente.lote}}</strong>
                </td>
                <td>Activo</td>
                <td class="ws-nowrap">25 ene. 2018</td>
                <td class="ws-nowrap">30 nov. 1899</td>
                <td class="text-right">
                  <button mat-icon-button [matMenuTriggerFor]="menu3" (click)="$event.stopPropagation()">
                    <mat-icon>more_vert</mat-icon>
                  </button>
                  <mat-menu #menu3="matMenu">
                    <button mat-menu-item (click)="delLote()">
                      <mat-icon>delete</mat-icon>
                      <span>Eliminar</span>
                    </button>
                    <button mat-menu-item>
                      <mat-icon>clear</mat-icon>
                      <span>Cancelar</span>
                    </button>
                  </mat-menu>

                </td>
              </tr>
            </tbody>
          </table>
        </div>


        <!-- propiedades del lote -->

        <form [formGroup]="formInmueble" (ngSubmit)="guardarInmueble()" *ngIf="cliente_selected">

          <div class="form-group row mt-3">
            <label for="id_estado" class="col-form-label col-sm-3">Estado</label>
            <div class="col-sm-9">
              <select class="form-control" id="id_estado" name="id_estado" formControlName="id_estado" [(ngModel)]="estados_selected" [ngClass]="{'is-invalid':formInmueble.get('id_estado').invalid && (formInmueble.get('id_estado').dirty || formInmueble.get('id_estado').touched )}">
                <option [value]="1">Apartado</option>
                <option [value]="2">Checklist</option>
                <option [value]="3">Infonavit</option>
                <option [value]="4">Firma</option>
                <option [value]="5">Entrega</option>
              </select>
              <div *ngIf="formInmueble.get('id_estado').invalid && (formInmueble.get('id_estado').dirty || formInmueble.get('id_estado').touched )"
                class="visible invalid-feedback">
                Seleccione un estado
              </div>
            </div>
          </div>

          <div class="form-group row" *ngIf="estados_selected == '1'">
            <label for="fecha_apartado" class="col-form-label col-sm-3">Fecha Apartado</label>
            <div class="input-group col-sm-9">
              <input id="fecha_apartado" name="fecha_apartado" formControlName="fecha_apartado" class="form-control" placeholder="yyyy-mm-dd"
                type="text" placement="bottom-left" [matDatepicker]="dpFechaApartado" [ngClass]="{'is-invalid':formInmueble.get('fecha_apartado').invalid && (formInmueble.get('fecha_apartado').dirty || formInmueble.get('fecha_apartado').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaApartado.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('fecha_apartado').invalid && (formInmueble.get('fecha_apartado').dirty || formInmueble.get('fecha_apartado').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaApartado></mat-datepicker>
          </div>

          <div class="form-group row" *ngIf="estados_selected == '2'">
            <label for="fecha_checklist" class="col-form-label col-sm-3">Fecha Checklist</label>
            <div class="input-group col-sm-9">
              <input id="fecha_checklist" name="fecha_checklist" formControlName="fecha_checklist" class="form-control" placeholder="yyyy-mm-dd"
                type="text" placement="bottom-left" [matDatepicker]="dpFechaChecklist" [ngClass]="{'is-invalid':formInmueble.get('fecha_checklist').invalid && (formInmueble.get('fecha_checklist').dirty || formInmueble.get('fecha_checklist').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaChecklist.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('fecha_checklist').invalid && (formInmueble.get('fecha_checklist').dirty || formInmueble.get('fecha_checklist').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaChecklist></mat-datepicker>
          </div>

          <div class="form-group row" *ngIf="estados_selected == '3'">
            <label for="fecha_infonavit" class="col-form-label col-sm-3">Fecha Infonavit</label>
            <div class="input-group col-sm-9">
              <input id="fecha_infonavit" name="fecha_infonavit" formControlName="fecha_infonavit" class="form-control" placeholder="yyyy-mm-dd"
                type="text" placement="bottom-left" [matDatepicker]="dpFechaInfonavit" [ngClass]="{'is-invalid':formInmueble.get('fecha_infonavit').invalid && (formInmueble.get('fecha_infonavit').dirty || formInmueble.get('fecha_infonavit').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaInfonavit.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('fecha_infonavit').invalid && (formInmueble.get('fecha_infonavit').dirty || formInmueble.get('fecha_infonavit').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaInfonavit></mat-datepicker>
          </div>

          <div class="form-group row" *ngIf="estados_selected == '4'">
            <label for="fecha_firma" class="col-form-label col-sm-3">Fecha Firma</label>
            <div class="input-group col-sm-9">
              <input id="fecha_firma" name="fecha_firma" formControlName="fecha_firma" class="form-control" placeholder="yyyy-mm-dd" type="text"
                placement="bottom-left" [matDatepicker]="dpFechaFirma" [ngClass]="{'is-invalid':formInmueble.get('fecha_firma').invalid && (formInmueble.get('fecha_firma').dirty || formInmueble.get('fecha_firma').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaFirma.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('fecha_firma').invalid && (formInmueble.get('fecha_firma').dirty || formInmueble.get('fecha_firma').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaFirma></mat-datepicker>
          </div>

          <div class="form-group row" *ngIf="estados_selected == '5'">
            <label for="fecha_entregado" class="col-form-label col-sm-3">Fecha Entrega</label>
            <div class="input-group col-sm-9">
              <input id="fecha_entrega" name="fecha_entrega" formControlName="fecha_entrega" class="form-control" placeholder="yyyy-mm-dd"
                type="text" placement="bottom-left" [matDatepicker]="dpFechaEntrega" [ngClass]="{'is-invalid':formInmueble.get('fecha_entrega').invalid && (formInmueble.get('fecha_entrega').dirty || formInmueble.get('fecha_entrega').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaEntrega.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('fecha_entrega').invalid && (formInmueble.get('fecha_entrega').dirty || formInmueble.get('fecha_entrega').touched )"
                class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaEntrega></mat-datepicker>
          </div>

          <div class="form-group row">
            <label class="col-form-label col-sm-3">Precio Venta</label>
            <div class="col-sm-9">
              <input [textMask]="{mask: numbermask}" type="text" class="form-control" name="precio_lista" formControlName="precio_lista"
                [ngClass]="{'is-invalid':formInmueble.get('precio_lista').invalid && (formInmueble.get('precio_lista').dirty || formInmueble.get('precio_lista').touched )}">
              <div *ngIf="formInmueble.get('precio_lista').invalid && (formInmueble.get('precio_lista').dirty || formInmueble.get('precio_lista').touched )"
                class="visible invalid-feedback">
                Indique un precio
              </div>
            </div>
          </div>

          <div class="form-group row mt-3">
            <label class="col-form-label col-sm-3">Vendedor</label>
            <div class="col-sm-9">
              <select class="form-control" name="id_vendedor" formControlName="id_vendedor" [ngClass]="{'is-invalid':formInmueble.get('id_vendedor').invalid && (formInmueble.get('id_vendedor').dirty || formInmueble.get('id_vendedor').touched )}">
                <option>Seleccionar...</option>
                <option>Vendedor 1</option>
              </select>
              <div *ngIf="formInmueble.get('id_vendedor').invalid && (formInmueble.get('id_vendedor').dirty || formInmueble.get('id_vendedor').touched )"
                class="visible invalid-feedback">
                Seleccione un vendedor
              </div>
            </div>
          </div>

          <div class="form-group row mt-3">
            <label class="col-form-label col-sm-3">Tipo Crédito</label>
            <div class="col-sm-9">
              <select class="form-control" name="tipo_credito" formControlName="tipo_credito" [ngClass]="{'is-invalid':formInmueble.get('tipo_credito').invalid && (formInmueble.get('tipo_credito').dirty || formInmueble.get('tipo_credito').touched )}">
                <option [value]="1">Crédito 1</option>
                <option [value]="2">Crédito 2</option>
              </select>
              <div *ngIf="formInmueble.get('tipo_credito').invalid && (formInmueble.get('tipo_credito').dirty || formInmueble.get('tipo_credito').touched )"
                class="visible invalid-feedback">
                Seleccione un crédito
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="dtu" class="col-form-label col-sm-3">DTU</label>
            <div class="input-group col-sm-9">
              <input class="form-control" placeholder="yyyy-mm-dd" type="text" id="dtu" placement="bottom-left" [matDatepicker]="dpFechaNacimiento"
                formControlName="dtu" [ngClass]="{'is-invalid':formInmueble.get('dtu').invalid && (formInmueble.get('dtu').dirty || formInmueble.get('dtu').touched )}">
              <span class="input-group-append">
                <button class="btn btn-secondary" type="button" (click)="dpFechaNacimiento.open()">
                  <i class="fa fa-calendar"></i>
                </button>
              </span>
              <div *ngIf="formInmueble.get('dtu').invalid && (formInmueble.get('dtu').dirty || formInmueble.get('dtu').touched )" class="visible invalid-feedback">
                Seleccione una fecha
              </div>
            </div>
            <mat-datepicker touchUi="true" #dpFechaNacimiento></mat-datepicker>
          </div>

        </form>




      </div>
    </mat-tab>




  </mat-tab-group>

</div>
<div mat-dialog-actions>
  <button mat-button type="button" [mat-dialog-close]="false">CANCELAR</button>
  <button type="submit" mat-button color="primary">GUARDAR</button>
</div>